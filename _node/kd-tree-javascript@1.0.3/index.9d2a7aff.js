var N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function T(w){return w&&w.__esModule&&Object.prototype.hasOwnProperty.call(w,"default")?w.default:w}var z={};(function(w){(function(F,m){m(w)})(N,function(F){function m(l,f,i){this.obj=l,this.left=null,this.right=null,this.parent=i,this.dimension=f}function M(l){this.content=[],this.scoreFunction=l}M.prototype={push:function(l){this.content.push(l),this.bubbleUp(this.content.length-1)},pop:function(){var l=this.content[0],f=this.content.pop();return this.content.length>0&&(this.content[0]=f,this.sinkDown(0)),l},peek:function(){return this.content[0]},remove:function(l){for(var f=this.content.length,i=0;i<f;i++)if(this.content[i]==l){var a=this.content.pop();return void(i!=f-1&&(this.content[i]=a,this.scoreFunction(a)<this.scoreFunction(l)?this.bubbleUp(i):this.sinkDown(i)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(l){for(var f=this.content[l];l>0;){var i=Math.floor((l+1)/2)-1,a=this.content[i];if(!(this.scoreFunction(f)<this.scoreFunction(a)))break;this.content[i]=f,this.content[l]=a,l=i}},sinkDown:function(l){for(var f=this.content.length,i=this.content[l],a=this.scoreFunction(i);;){var c=2*(l+1),n=c-1,o=null;if(n<f){var e=this.content[n],s=this.scoreFunction(e);s<a&&(o=n)}if(c<f){var t=this.content[c];this.scoreFunction(t)<(o==null?a:s)&&(o=c)}if(o==null)break;this.content[l]=this.content[o],this.content[o]=i,l=o}}},F.kdTree=function(l,f,i){function a(n,o,e){var s,t,u=o%i.length;return n.length===0?null:n.length===1?new m(n[0],u,e):(n.sort(function(h,r){return h[i[u]]-r[i[u]]}),s=Math.floor(n.length/2),t=new m(n[s],u,e),t.left=a(n.slice(0,s),o+1,t),t.right=a(n.slice(s+1),o+1,t),t)}var c=this;Array.isArray(l)?this.root=a(l,0,null):function(n){function o(e){e.left&&(e.left.parent=e,o(e.left)),e.right&&(e.right.parent=e,o(e.right))}c.root=n,o(c.root)}(l),this.toJSON=function(n){n||(n=this.root);var o=new m(n.obj,n.dimension,null);return n.left&&(o.left=c.toJSON(n.left)),n.right&&(o.right=c.toJSON(n.right)),o},this.insert=function(n){function o(u,h){if(u===null)return h;var r=i[u.dimension];return n[r]<u.obj[r]?o(u.left,u):o(u.right,u)}var e,s,t=o(this.root,null);t!==null?(e=new m(n,(t.dimension+1)%i.length,t),s=i[t.dimension],n[s]<t.obj[s]?t.left=e:t.right=e):this.root=new m(n,0,null)},this.remove=function(n){function o(t){if(t===null)return null;if(t.obj===n)return t;var u=i[t.dimension];return n[u]<t.obj[u]?o(t.left):o(t.right)}function e(t){function u(g,v){var j,b,k,d,p;return g===null?null:(j=i[v],g.dimension===v?g.left!==null?u(g.left,v):g:(b=g.obj[j],k=u(g.left,v),d=u(g.right,v),p=g,k!==null&&k.obj[j]<b&&(p=k),d!==null&&d.obj[j]<p.obj[j]&&(p=d),p))}var h,r,y;if(t.left===null&&t.right===null)return t.parent===null?void(c.root=null):(y=i[t.parent.dimension],void(t.obj[y]<t.parent.obj[y]?t.parent.left=null:t.parent.right=null));t.right!==null?(r=(h=u(t.right,t.dimension)).obj,e(h),t.obj=r):(r=(h=u(t.left,t.dimension)).obj,e(h),t.right=t.left,t.left=null,t.obj=r)}var s;(s=o(c.root))!==null&&e(s)},this.nearest=function(n,o,e){function s(r){function y(O,D){h.push([O,D]),h.size()>o&&h.pop()}var g,v,j,b,k=i[r.dimension],d=f(n,r.obj),p={};for(b=0;b<i.length;b+=1)b===r.dimension?p[i[b]]=n[i[b]]:p[i[b]]=r.obj[i[b]];v=f(p,r.obj),r.right!==null||r.left!==null?(s(g=r.right===null?r.left:r.left===null?r.right:n[k]<r.obj[k]?r.left:r.right),(h.size()<o||d<h.peek()[1])&&y(r,d),(h.size()<o||Math.abs(v)<h.peek()[1])&&(j=g===r.left?r.right:r.left)!==null&&s(j)):(h.size()<o||d<h.peek()[1])&&y(r,d)}var t,u,h;if(h=new M(function(r){return-r[1]}),e)for(t=0;t<o;t+=1)h.push([null,e]);for(c.root&&s(c.root),u=[],t=0;t<Math.min(o,h.content.length);t+=1)h.content[t][0]&&u.push([h.content[t][0].obj,h.content[t][1]]);return u},this.balanceFactor=function(){function n(e){return e===null?0:Math.max(n(e.left),n(e.right))+1}function o(e){return e===null?0:o(e.left)+o(e.right)+1}return n(c.root)/(Math.log(o(c.root))/Math.log(2))}},F.BinaryHeap=M})})(z);var E=T(z);export{E as default};
