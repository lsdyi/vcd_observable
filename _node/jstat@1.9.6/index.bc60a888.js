var $=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function C(P){return P&&P.__esModule&&Object.prototype.hasOwnProperty.call(P,"default")?P.default:P}var J={exports:{}};(function(P,W){(function(_,e){P.exports=e()})($,function(){var _=function(e,i){var d=Array.prototype.concat,p=Array.prototype.slice,b=Object.prototype.toString;function f(l,m){var h=l>m?l:m;return e.pow(10,17-~~(e.log(h>0?h:-h)*e.LOG10E))}var n=Array.isArray||function(l){return b.call(l)==="[object Array]"};function t(l){return b.call(l)==="[object Function]"}function r(l){return typeof l=="number"?l-l===0:!1}function o(l){return d.apply([],l)}function a(){return new a._init(arguments)}a.fn=a.prototype,a._init=function(l){if(n(l[0]))if(n(l[0][0])){t(l[1])&&(l[0]=a.map(l[0],l[1]));for(var m=0;m<l[0].length;m++)this[m]=l[0][m];this.length=l[0].length}else this[0]=t(l[1])?a.map(l[0],l[1]):l[0],this.length=1;else if(r(l[0]))this[0]=a.seq.apply(null,l),this.length=1;else{if(l[0]instanceof a)return a(l[0].toArray());this[0]=[],this.length=1}return this},a._init.prototype=a.prototype,a._init.constructor=a,a.utils={calcRdx:f,isArray:n,isFunction:t,isNumber:r,toVector:o},a._random_fn=e.random,a.setRandom=function(l){if(typeof l!="function")throw new TypeError("fn is not a function");a._random_fn=l},a.extend=function(l){var m,h;if(arguments.length===1){for(h in l)a[h]=l[h];return this}for(m=1;m<arguments.length;m++)for(h in arguments[m])l[h]=arguments[m][h];return l},a.rows=function(l){return l.length||1},a.cols=function(l){return l[0].length||1},a.dimensions=function(l){return{rows:a.rows(l),cols:a.cols(l)}},a.row=function(l,m){return n(m)?m.map(function(h){return a.row(l,h)}):l[m]},a.rowa=function(l,m){return a.row(l,m)},a.col=function(l,m){if(n(m)){var h=a.arange(l.length).map(function(){return new Array(m.length)});return m.forEach(function(y,x){a.arange(l.length).forEach(function(q){h[q][x]=l[q][y]})}),h}for(var v=new Array(l.length),w=0;w<l.length;w++)v[w]=[l[w][m]];return v},a.cola=function(l,m){return a.col(l,m).map(function(h){return h[0]})},a.diag=function(l){for(var m=a.rows(l),h=new Array(m),v=0;v<m;v++)h[v]=[l[v][v]];return h},a.antidiag=function(l){for(var m=a.rows(l)-1,h=new Array(m),v=0;m>=0;m--,v++)h[v]=[l[v][m]];return h},a.transpose=function(l){var m=[],h,v,w,y,x;for(n(l[0])||(l=[l]),v=l.length,w=l[0].length,x=0;x<w;x++){for(h=new Array(v),y=0;y<v;y++)h[y]=l[y][x];m.push(h)}return m.length===1?m[0]:m},a.map=function(l,m,h){var v,w,y,x,q;for(n(l[0])||(l=[l]),w=l.length,y=l[0].length,x=h?l:new Array(w),v=0;v<w;v++)for(x[v]||(x[v]=new Array(y)),q=0;q<y;q++)x[v][q]=m(l[v][q],v,q);return x.length===1?x[0]:x},a.cumreduce=function(l,m,h){var v,w,y,x,q;for(n(l[0])||(l=[l]),w=l.length,y=l[0].length,x=h?l:new Array(w),v=0;v<w;v++)for(x[v]||(x[v]=new Array(y)),y>0&&(x[v][0]=l[v][0]),q=1;q<y;q++)x[v][q]=m(x[v][q-1],l[v][q]);return x.length===1?x[0]:x},a.alter=function(l,m){return a.map(l,m,!0)},a.create=function(l,m,h){var v=new Array(l),w,y;for(t(m)&&(h=m,m=l),w=0;w<l;w++)for(v[w]=new Array(m),y=0;y<m;y++)v[w][y]=h(w,y);return v};function c(){return 0}a.zeros=function(l,m){return r(m)||(m=l),a.create(l,m,c)};function u(){return 1}a.ones=function(l,m){return r(m)||(m=l),a.create(l,m,u)},a.rand=function(l,m){return r(m)||(m=l),a.create(l,m,a._random_fn)};function s(l,m){return l===m?1:0}a.identity=function(l,m){return r(m)||(m=l),a.create(l,m,s)},a.symmetric=function(l){var m=l.length,h,v;if(l.length!==l[0].length)return!1;for(h=0;h<m;h++)for(v=0;v<m;v++)if(l[v][h]!==l[h][v])return!1;return!0},a.clear=function(l){return a.alter(l,c)},a.seq=function(l,m,h,v){t(v)||(v=!1);var w=[],y=f(l,m),x=(m*y-l*y)/((h-1)*y),q=l,A;for(A=0;q<=m&&A<h;A++,q=(l*y+x*y*A)/y)w.push(v?v(q,A):q);return w},a.arange=function(l,m,h){var v=[],w;if(h=h||1,m===i&&(m=l,l=0),l===m||h===0)return[];if(l<m&&h<0)return[];if(l>m&&h>0)return[];if(h>0)for(w=l;w<m;w+=h)v.push(w);else for(w=l;w>m;w+=h)v.push(w);return v},a.slice=function(){function l(h,v,w,y){var x,q=[],A=h.length;if(v===i&&w===i&&y===i)return a.copy(h);if(v=v||0,w=w||h.length,v=v>=0?v:A+v,w=w>=0?w:A+w,y=y||1,v===w||y===0)return[];if(v<w&&y<0)return[];if(v>w&&y>0)return[];if(y>0)for(x=v;x<w;x+=y)q.push(h[x]);else for(x=v;x>w;x+=y)q.push(h[x]);return q}function m(h,v){var w,y;if(v=v||{},r(v.row)){if(r(v.col))return h[v.row][v.col];var x=a.rowa(h,v.row);return w=v.col||{},l(x,w.start,w.end,w.step)}if(r(v.col)){var q=a.cola(h,v.col);return y=v.row||{},l(q,y.start,y.end,y.step)}y=v.row||{},w=v.col||{};var A=l(h,y.start,y.end,y.step);return A.map(function(R){return l(R,w.start,w.end,w.step)})}return m}(),a.sliceAssign=function(l,m,h){var v,w;if(r(m.row)){if(r(m.col))return l[m.row][m.col]=h;m.col=m.col||{},m.col.start=m.col.start||0,m.col.end=m.col.end||l[0].length,m.col.step=m.col.step||1,v=a.arange(m.col.start,e.min(l.length,m.col.end),m.col.step);var y=m.row;return v.forEach(function(q,A){l[y][q]=h[A]}),l}if(r(m.col)){m.row=m.row||{},m.row.start=m.row.start||0,m.row.end=m.row.end||l.length,m.row.step=m.row.step||1,w=a.arange(m.row.start,e.min(l[0].length,m.row.end),m.row.step);var x=m.col;return w.forEach(function(q,A){l[q][x]=h[A]}),l}return h[0].length===i&&(h=[h]),m.row.start=m.row.start||0,m.row.end=m.row.end||l.length,m.row.step=m.row.step||1,m.col.start=m.col.start||0,m.col.end=m.col.end||l[0].length,m.col.step=m.col.step||1,w=a.arange(m.row.start,e.min(l.length,m.row.end),m.row.step),v=a.arange(m.col.start,e.min(l[0].length,m.col.end),m.col.step),w.forEach(function(q,A){v.forEach(function(R,k){l[q][R]=h[A][k]})}),l},a.diagonal=function(l){var m=a.zeros(l.length,l.length);return l.forEach(function(h,v){m[v][v]=h}),m},a.copy=function(l){return l.map(function(m){return r(m)?m:m.map(function(h){return h})})};var g=a.prototype;return g.length=0,g.push=Array.prototype.push,g.sort=Array.prototype.sort,g.splice=Array.prototype.splice,g.slice=Array.prototype.slice,g.toArray=function(){return this.length>1?p.call(this):p.call(this)[0]},g.map=function(l,m){return a(a.map(this,l,m))},g.cumreduce=function(l,m){return a(a.cumreduce(this,l,m))},g.alter=function(l){return a.alter(this,l),this},function(l){for(var m=0;m<l.length;m++)(function(h){g[h]=function(v){var w=this,y;return v?(setTimeout(function(){v.call(w,g[h].call(w))}),this):(y=a[h](this),n(y)?a(y):y)}})(l[m])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(l){for(var m=0;m<l.length;m++)(function(h){g[h]=function(v,w){var y=this;return w?(setTimeout(function(){w.call(y,g[h].call(y,v))}),this):a(a[h](this,v))}})(l[m])}("row col".split(" ")),function(l){for(var m=0;m<l.length;m++)(function(h){g[h]=function(){return a(a[h].apply(null,arguments))}})(l[m])}("create zeros ones rand identity".split(" ")),a}(Math);return function(e,i){var d=e.utils.isFunction;function p(n,t){return n-t}function b(n,t,r){return i.max(t,i.min(n,r))}e.sum=function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r];return t},e.sumsqrd=function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r]*n[r];return t},e.sumsqerr=function(n){for(var t=e.mean(n),r=0,o=n.length,a;--o>=0;)a=n[o]-t,r+=a*a;return r},e.sumrow=function(n){for(var t=0,r=n.length;--r>=0;)t+=n[r];return t},e.product=function(n){for(var t=1,r=n.length;--r>=0;)t*=n[r];return t},e.min=function(n){for(var t=n[0],r=0;++r<n.length;)n[r]<t&&(t=n[r]);return t},e.max=function(n){for(var t=n[0],r=0;++r<n.length;)n[r]>t&&(t=n[r]);return t},e.unique=function(n){for(var t={},r=[],o=0;o<n.length;o++)t[n[o]]||(t[n[o]]=!0,r.push(n[o]));return r},e.mean=function(n){return e.sum(n)/n.length},e.meansqerr=function(n){return e.sumsqerr(n)/n.length},e.geomean=function(n){var t=n.map(i.log),r=e.mean(t);return i.exp(r)},e.median=function(n){var t=n.length,r=n.slice().sort(p);return t&1?r[t/2|0]:(r[t/2-1]+r[t/2])/2},e.cumsum=function(n){return e.cumreduce(n,function(t,r){return t+r})},e.cumprod=function(n){return e.cumreduce(n,function(t,r){return t*r})},e.diff=function(n){var t=[],r=n.length,o;for(o=1;o<r;o++)t.push(n[o]-n[o-1]);return t},e.rank=function(n){var t,r=[],o={};for(t=0;t<n.length;t++){var a=n[t];o[a]?o[a]++:(o[a]=1,r.push(a))}var c=r.sort(p),u={},s=1;for(t=0;t<c.length;t++){var a=c[t],g=o[a],l=s,m=s+g-1,h=(l+m)/2;u[a]=h,s+=g}return n.map(function(v){return u[v]})},e.mode=function(n){var t=n.length,r=n.slice().sort(p),o=1,a=0,c=0,u=[],s;for(s=0;s<t;s++)r[s]===r[s+1]?o++:(o>a?(u=[r[s]],a=o,c=0):o===a&&(u.push(r[s]),c++),o=1);return c===0?u[0]:u},e.range=function(n){return e.max(n)-e.min(n)},e.variance=function(n,t){return e.sumsqerr(n)/(n.length-(t?1:0))},e.pooledvariance=function(n){var t=n.reduce(function(o,a){return o+e.sumsqerr(a)},0),r=n.reduce(function(o,a){return o+a.length},0);return t/(r-n.length)},e.deviation=function(n){for(var t=e.mean(n),r=n.length,o=new Array(r),a=0;a<r;a++)o[a]=n[a]-t;return o},e.stdev=function(n,t){return i.sqrt(e.variance(n,t))},e.pooledstdev=function(n){return i.sqrt(e.pooledvariance(n))},e.meandev=function(n){for(var t=e.mean(n),r=[],o=n.length-1;o>=0;o--)r.push(i.abs(n[o]-t));return e.mean(r)},e.meddev=function(n){for(var t=e.median(n),r=[],o=n.length-1;o>=0;o--)r.push(i.abs(n[o]-t));return e.median(r)},e.coeffvar=function(n){return e.stdev(n)/e.mean(n)},e.quartiles=function(n){var t=n.length,r=n.slice().sort(p);return[r[i.round(t/4)-1],r[i.round(t/2)-1],r[i.round(t*3/4)-1]]},e.quantiles=function(n,t,r,o){var a=n.slice().sort(p),c=[t.length],u=n.length,s,g,l,m,h,v;for(typeof r>"u"&&(r=3/8),typeof o>"u"&&(o=3/8),s=0;s<t.length;s++)g=t[s],l=r+g*(1-r-o),m=u*g+l,h=i.floor(b(m,1,u-1)),v=b(m-h,0,1),c[s]=(1-v)*a[h-1]+v*a[h];return c},e.percentile=function(n,t,r){var o=n.slice().sort(p),a=t*(o.length+(r?1:-1))+(r?0:1),c=parseInt(a),u=a-c;return c+1<o.length?o[c-1]+u*(o[c]-o[c-1]):o[c-1]},e.percentileOfScore=function(n,t,r){var o=0,a=n.length,c=!1,u,s;for(r==="strict"&&(c=!0),s=0;s<a;s++)u=n[s],(c&&u<t||!c&&u<=t)&&o++;return o/a},e.histogram=function(n,t){t=t||4;var r=e.min(n),o=(e.max(n)-r)/t,a=n.length,c=[],u;for(u=0;u<t;u++)c[u]=0;for(u=0;u<a;u++)c[i.min(i.floor((n[u]-r)/o),t-1)]+=1;return c},e.covariance=function(n,t){var r=e.mean(n),o=e.mean(t),a=n.length,c=new Array(a),u;for(u=0;u<a;u++)c[u]=(n[u]-r)*(t[u]-o);return e.sum(c)/(a-1)},e.corrcoeff=function(n,t){return e.covariance(n,t)/e.stdev(n,1)/e.stdev(t,1)},e.spearmancoeff=function(n,t){return n=e.rank(n),t=e.rank(t),e.corrcoeff(n,t)},e.stanMoment=function(n,t){for(var r=e.mean(n),o=e.stdev(n),a=n.length,c=0,u=0;u<a;u++)c+=i.pow((n[u]-r)/o,t);return c/n.length},e.skewness=function(n){return e.stanMoment(n,3)},e.kurtosis=function(n){return e.stanMoment(n,4)-3};var f=e.prototype;(function(n){for(var t=0;t<n.length;t++)(function(r){f[r]=function(o,a){var c=[],u=0,s=this;if(d(o)&&(a=o,o=!1),a)return setTimeout(function(){a.call(s,f[r].call(s,o))}),this;if(this.length>1){for(s=o===!0?this:this.transpose();u<s.length;u++)c[u]=e[r](s[u]);return c}return e[r](this[0],o)}})(n[t])})("cumsum cumprod".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(r){f[r]=function(o,a){var c=[],u=0,s=this;if(d(o)&&(a=o,o=!1),a)return setTimeout(function(){a.call(s,f[r].call(s,o))}),this;if(this.length>1){for(r!=="sumrow"&&(s=o===!0?this:this.transpose());u<s.length;u++)c[u]=e[r](s[u]);return o===!0?e[r](e.utils.toVector(c)):c}return e[r](this[0],o)}})(n[t])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(n){for(var t=0;t<n.length;t++)(function(r){f[r]=function(){var o=[],a=0,c=this,u=Array.prototype.slice.call(arguments),s;if(d(u[u.length-1])){s=u[u.length-1];var g=u.slice(0,u.length-1);return setTimeout(function(){s.call(c,f[r].apply(c,g))}),this}else{s=void 0;var l=function(m){return e[r].apply(c,[m].concat(u))}}if(this.length>1){for(c=c.transpose();a<c.length;a++)o[a]=l(c[a]);return o}return l(this[0])}})(n[t])}("quantiles percentileOfScore".split(" "))}(_,Math),function(e,i){e.gammaln=function(d){var p=0,b=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],f=1.000000000190015,n,t,r;for(r=(t=n=d)+5.5,r-=(n+.5)*i.log(r);p<6;p++)f+=b[p]/++t;return i.log(2.5066282746310007*f/n)-r},e.loggam=function(d){var p,b,f,n,t,r,o,a=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(p=d,o=0,d==1||d==2)return 0;for(d<=7&&(o=i.floor(7-d),p=d+o),b=1/(p*p),f=2*i.PI,t=a[9],r=8;r>=0;r--)t*=b,t+=a[r];if(n=t/p+.5*i.log(f)+(p-.5)*i.log(p)-p,d<=7)for(r=1;r<=o;r++)n-=i.log(p-1),p-=1;return n},e.gammafn=function(d){var p=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],b=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],f=!1,n=0,t=0,r=0,o=d,a,c,u,s;if(d>171.6243769536076)return 1/0;if(o<=0)if(s=o%1+36e-17,s)f=(o&1?-1:1)*i.PI/i.sin(i.PI*s),o=1-o;else return 1/0;for(u=o,o<1?c=o++:c=(o-=n=(o|0)-1)-1,a=0;a<8;++a)r=(r+p[a])*c,t=t*c+b[a];if(s=r/t+1,u<o)s/=u;else if(u>o)for(a=0;a<n;++a)s*=o,o++;return f&&(s=f/s),s},e.gammap=function(d,p){return e.lowRegGamma(d,p)*e.gammafn(d)},e.lowRegGamma=function(d,p){var b=e.gammaln(d),f=d,n=1/d,t=n,r=p+1-d,o=1/1e-30,a=1/r,c=a,u=1,s=-~(i.log(d>=1?d:1/d)*8.5+d*.4+17),g;if(p<0||d<=0)return NaN;if(p<d+1){for(;u<=s;u++)n+=t*=p/++f;return n*i.exp(-p+d*i.log(p)-b)}for(;u<=s;u++)g=-u*(u-d),r+=2,a=g*a+r,o=r+g/o,a=1/a,c*=a*o;return 1-c*i.exp(-p+d*i.log(p)-b)},e.factorialln=function(d){return d<0?NaN:e.gammaln(d+1)},e.factorial=function(d){return d<0?NaN:e.gammafn(d+1)},e.combination=function(d,p){return d>170||p>170?i.exp(e.combinationln(d,p)):e.factorial(d)/e.factorial(p)/e.factorial(d-p)},e.combinationln=function(d,p){return e.factorialln(d)-e.factorialln(p)-e.factorialln(d-p)},e.permutation=function(d,p){return e.factorial(d)/e.factorial(d-p)},e.betafn=function(d,p){if(!(d<=0||p<=0))return d+p>170?i.exp(e.betaln(d,p)):e.gammafn(d)*e.gammafn(p)/e.gammafn(d+p)},e.betaln=function(d,p){return e.gammaln(d)+e.gammaln(p)-e.gammaln(d+p)},e.betacf=function(d,p,b){var f=1e-30,n=1,t=p+b,r=p+1,o=p-1,a=1,c=1-t*d/r,u,s,g,l;for(i.abs(c)<f&&(c=f),c=1/c,l=c;n<=100&&(u=2*n,s=n*(b-n)*d/((o+u)*(p+u)),c=1+s*c,i.abs(c)<f&&(c=f),a=1+s/a,i.abs(a)<f&&(a=f),c=1/c,l*=c*a,s=-(p+n)*(t+n)*d/((p+u)*(r+u)),c=1+s*c,i.abs(c)<f&&(c=f),a=1+s/a,i.abs(a)<f&&(a=f),c=1/c,g=c*a,l*=g,!(i.abs(g-1)<3e-7));n++);return l},e.gammapinv=function(d,p){var b=0,f=p-1,n=1e-8,t=e.gammaln(p),r,o,a,c,u,s,g;if(d>=1)return i.max(100,p+100*i.sqrt(p));if(d<=0)return 0;for(p>1?(s=i.log(f),g=i.exp(f*(s-1)-t),u=d<.5?d:1-d,a=i.sqrt(-2*i.log(u)),r=(2.30753+a*.27061)/(1+a*(.99229+a*.04481))-a,d<.5&&(r=-r),r=i.max(.001,p*i.pow(1-1/(9*p)-r/(3*i.sqrt(p)),3))):(a=1-p*(.253+p*.12),d<a?r=i.pow(d/a,1/p):r=1-i.log(1-(d-a)/(1-a)));b<12;b++){if(r<=0)return 0;if(o=e.lowRegGamma(p,r)-d,p>1?a=g*i.exp(-(r-f)+f*(i.log(r)-s)):a=i.exp(-r+f*i.log(r)-t),c=o/a,r-=a=c/(1-.5*i.min(1,c*((p-1)/r-1))),r<=0&&(r=.5*(r+a)),i.abs(a)<n*r)break}return r},e.erf=function(d){var p=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],b=p.length-1,f=!1,n=0,t=0,r,o,a,c;for(d<0&&(d=-d,f=!0),r=2/(2+d),o=4*r-2;b>0;b--)a=n,n=o*n-t+p[b],t=a;return c=r*i.exp(-d*d+.5*(p[0]+o*n)-t),f?c-1:1-c},e.erfc=function(d){return 1-e.erf(d)},e.erfcinv=function(d){var p=0,b,f,n,t;if(d>=2)return-100;if(d<=0)return 100;for(t=d<1?d:2-d,n=i.sqrt(-2*i.log(t/2)),b=-.70711*((2.30753+n*.27061)/(1+n*(.99229+n*.04481))-n);p<2;p++)f=e.erfc(b)-t,b+=f/(1.1283791670955126*i.exp(-b*b)-b*f);return d<1?b:-b},e.ibetainv=function(d,p,b){var f=1e-8,n=p-1,t=b-1,r=0,o,a,c,u,s,g,l,m,h,v,w;if(d<=0)return 0;if(d>=1)return 1;for(p>=1&&b>=1?(c=d<.5?d:1-d,u=i.sqrt(-2*i.log(c)),l=(2.30753+u*.27061)/(1+u*(.99229+u*.04481))-u,d<.5&&(l=-l),m=(l*l-3)/6,h=2/(1/(2*p-1)+1/(2*b-1)),v=l*i.sqrt(m+h)/h-(1/(2*b-1)-1/(2*p-1))*(m+5/6-2/(3*h)),l=p/(p+b*i.exp(2*v))):(o=i.log(p/(p+b)),a=i.log(b/(p+b)),u=i.exp(p*o)/p,s=i.exp(b*a)/b,v=u+s,d<u/v?l=i.pow(p*v*d,1/p):l=1-i.pow(b*v*(1-d),1/b)),w=-e.gammaln(p)-e.gammaln(b)+e.gammaln(p+b);r<10;r++){if(l===0||l===1)return l;if(g=e.ibeta(l,p,b)-d,u=i.exp(n*i.log(l)+t*i.log(1-l)+w),s=g/u,l-=u=s/(1-.5*i.min(1,s*(n/l-t/(1-l)))),l<=0&&(l=.5*(l+u)),l>=1&&(l=.5*(l+u+1)),i.abs(u)<f*l&&r>0)break}return l},e.ibeta=function(d,p,b){var f=d===0||d===1?0:i.exp(e.gammaln(p+b)-e.gammaln(p)-e.gammaln(b)+p*i.log(d)+b*i.log(1-d));return d<0||d>1?!1:d<(p+1)/(p+b+2)?f*e.betacf(d,p,b)/p:1-f*e.betacf(1-d,b,p)/b},e.randn=function(d,p){var b,f,n,t,r;if(p||(p=d),d)return e.create(d,p,function(){return e.randn()});do b=e._random_fn(),f=1.7156*(e._random_fn()-.5),n=b-.449871,t=i.abs(f)+.386595,r=n*n+t*(.196*t-.25472*n);while(r>.27597&&(r>.27846||f*f>-4*i.log(b)*b*b));return f/b},e.randg=function(d,p,b){var f=d,n,t,r,o,a,c;if(b||(b=p),d||(d=1),p)return c=e.zeros(p,b),c.alter(function(){return e.randg(d)}),c;d<1&&(d+=1),n=d-1/3,t=1/i.sqrt(9*n);do{do a=e.randn(),o=1+t*a;while(o<=0);o=o*o*o,r=e._random_fn()}while(r>1-.331*i.pow(a,4)&&i.log(r)>.5*a*a+n*(1-o+i.log(o)));if(d==f)return n*o;do r=e._random_fn();while(r===0);return i.pow(r,1/f)*n*o},function(d){for(var p=0;p<d.length;p++)(function(b){e.fn[b]=function(){return e(e.map(this,function(f){return e[b](f)}))}})(d[p])}("gammaln gammafn factorial factorialln".split(" ")),function(d){for(var p=0;p<d.length;p++)(function(b){e.fn[b]=function(){return e(e[b].apply(null,arguments))}})(d[p])}("randn".split(" "))}(_,Math),function(e,i){(function(n){for(var t=0;t<n.length;t++)(function(r){e[r]=function o(a,c,u){return this instanceof o?(this._a=a,this._b=c,this._c=u,this):new o(a,c,u)},e.fn[r]=function(o,a,c){var u=e[r](o,a,c);return u.data=this,u},e[r].prototype.sample=function(o){var a=this._a,c=this._b,u=this._c;return o?e.alter(o,function(){return e[r].sample(a,c,u)}):e[r].sample(a,c,u)},function(o){for(var a=0;a<o.length;a++)(function(c){e[r].prototype[c]=function(u){var s=this._a,g=this._b,l=this._c;return!u&&u!==0&&(u=this.data),typeof u!="number"?e.fn.map.call(u,function(m){return e[r][c](m,s,g,l)}):e[r][c](u,s,g,l)}})(o[a])}("pdf cdf inv".split(" ")),function(o){for(var a=0;a<o.length;a++)(function(c){e[r].prototype[c]=function(){return e[r][c](this._a,this._b,this._c)}})(o[a])}("mean median mode variance".split(" "))})(n[t])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),e.extend(e.beta,{pdf:function(n,t,r){return n>1||n<0?0:t==1&&r==1?1:t<512&&r<512?i.pow(n,t-1)*i.pow(1-n,r-1)/e.betafn(t,r):i.exp((t-1)*i.log(n)+(r-1)*i.log(1-n)-e.betaln(t,r))},cdf:function(n,t,r){return n>1||n<0?(n>1)*1:e.ibeta(n,t,r)},inv:function(n,t,r){return e.ibetainv(n,t,r)},mean:function(n,t){return n/(n+t)},median:function(n,t){return e.ibetainv(.5,n,t)},mode:function(n,t){return(n-1)/(n+t-2)},sample:function(n,t){var r=e.randg(n);return r/(r+e.randg(t))},variance:function(n,t){return n*t/(i.pow(n+t,2)*(n+t+1))}}),e.extend(e.centralF,{pdf:function(n,t,r){var o,a,c;return n<0?0:t<=2?n===0&&t<2?1/0:n===0&&t===2?1:1/e.betafn(t/2,r/2)*i.pow(t/r,t/2)*i.pow(n,t/2-1)*i.pow(1+t/r*n,-(t+r)/2):(o=t*n/(r+n*t),a=r/(r+n*t),c=t*a/2,c*e.binomial.pdf((t-2)/2,(t+r-2)/2,o))},cdf:function(n,t,r){return n<0?0:e.ibeta(t*n/(t*n+r),t/2,r/2)},inv:function(n,t,r){return r/(t*(1/e.ibetainv(n,t/2,r/2)-1))},mean:function(n,t){return t>2?t/(t-2):void 0},mode:function(n,t){return n>2?t*(n-2)/(n*(t+2)):void 0},sample:function(n,t){var r=e.randg(n/2)*2,o=e.randg(t/2)*2;return r/n/(o/t)},variance:function(n,t){if(!(t<=4))return 2*t*t*(n+t-2)/(n*(t-2)*(t-2)*(t-4))}}),e.extend(e.cauchy,{pdf:function(n,t,r){return r<0?0:r/(i.pow(n-t,2)+i.pow(r,2))/i.PI},cdf:function(n,t,r){return i.atan((n-t)/r)/i.PI+.5},inv:function(n,t,r){return t+r*i.tan(i.PI*(n-.5))},median:function(n){return n},mode:function(n){return n},sample:function(n,t){return e.randn()*i.sqrt(1/(2*e.randg(.5)))*t+n}}),e.extend(e.chisquare,{pdf:function(n,t){return n<0?0:n===0&&t===2?.5:i.exp((t/2-1)*i.log(n)-n/2-t/2*i.log(2)-e.gammaln(t/2))},cdf:function(n,t){return n<0?0:e.lowRegGamma(t/2,n/2)},inv:function(n,t){return 2*e.gammapinv(n,.5*t)},mean:function(n){return n},median:function(n){return n*i.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(n){return e.randg(n/2)*2},variance:function(n){return 2*n}}),e.extend(e.exponential,{pdf:function(n,t){return n<0?0:t*i.exp(-t*n)},cdf:function(n,t){return n<0?0:1-i.exp(-t*n)},inv:function(n,t){return-i.log(1-n)/t},mean:function(n){return 1/n},median:function(n){return 1/n*i.log(2)},mode:function(){return 0},sample:function(n){return-1/n*i.log(e._random_fn())},variance:function(n){return i.pow(n,-2)}}),e.extend(e.gamma,{pdf:function(n,t,r){return n<0?0:n===0&&t===1?1/r:i.exp((t-1)*i.log(n)-n/r-e.gammaln(t)-t*i.log(r))},cdf:function(n,t,r){return n<0?0:e.lowRegGamma(t,n/r)},inv:function(n,t,r){return e.gammapinv(n,t)*r},mean:function(n,t){return n*t},mode:function(n,t){if(n>1)return(n-1)*t},sample:function(n,t){return e.randg(n)*t},variance:function(n,t){return n*t*t}}),e.extend(e.invgamma,{pdf:function(n,t,r){return n<=0?0:i.exp(-(t+1)*i.log(n)-r/n-e.gammaln(t)+t*i.log(r))},cdf:function(n,t,r){return n<=0?0:1-e.lowRegGamma(t,r/n)},inv:function(n,t,r){return r/e.gammapinv(1-n,t)},mean:function(n,t){return n>1?t/(n-1):void 0},mode:function(n,t){return t/(n+1)},sample:function(n,t){return t/e.randg(n)},variance:function(n,t){if(!(n<=2))return t*t/((n-1)*(n-1)*(n-2))}}),e.extend(e.kumaraswamy,{pdf:function(n,t,r){return n===0&&t===1?r:n===1&&r===1?t:i.exp(i.log(t)+i.log(r)+(t-1)*i.log(n)+(r-1)*i.log(1-i.pow(n,t)))},cdf:function(n,t,r){return n<0?0:n>1?1:1-i.pow(1-i.pow(n,t),r)},inv:function(n,t,r){return i.pow(1-i.pow(1-n,1/r),1/t)},mean:function(n,t){return t*e.gammafn(1+1/n)*e.gammafn(t)/e.gammafn(1+1/n+t)},median:function(n,t){return i.pow(1-i.pow(2,-1/t),1/n)},mode:function(n,t){if(n>=1&&t>=1&&n!==1&&t!==1)return i.pow((n-1)/(n*t-1),1/n)},variance:function(){throw new Error("variance not yet implemented")}}),e.extend(e.lognormal,{pdf:function(n,t,r){return n<=0?0:i.exp(-i.log(n)-.5*i.log(2*i.PI)-i.log(r)-i.pow(i.log(n)-t,2)/(2*r*r))},cdf:function(n,t,r){return n<0?0:.5+.5*e.erf((i.log(n)-t)/i.sqrt(2*r*r))},inv:function(n,t,r){return i.exp(-1.4142135623730951*r*e.erfcinv(2*n)+t)},mean:function(n,t){return i.exp(n+t*t/2)},median:function(n){return i.exp(n)},mode:function(n,t){return i.exp(n-t*t)},sample:function(n,t){return i.exp(e.randn()*t+n)},variance:function(n,t){return(i.exp(t*t)-1)*i.exp(2*n+t*t)}}),e.extend(e.noncentralt,{pdf:function(n,t,r){var o=1e-14;return i.abs(r)<o?e.studentt.pdf(n,t):i.abs(n)<o?i.exp(e.gammaln((t+1)/2)-r*r/2-.5*i.log(i.PI*t)-e.gammaln(t/2)):t/n*(e.noncentralt.cdf(n*i.sqrt(1+2/t),t+2,r)-e.noncentralt.cdf(n,t,r))},cdf:function(n,t,r){var o=1e-14,a=200;if(i.abs(r)<o)return e.studentt.cdf(n,t);var c=!1;n<0&&(c=!0,r=-r);for(var u=e.normal.cdf(-r,0,1),s=o+1,g=s,l=n*n/(n*n+t),m=0,h=i.exp(-r*r/2),v=i.exp(-r*r/2-.5*i.log(2)-e.gammaln(3/2))*r;m<a||g>o||s>o;)g=s,m>0&&(h*=r*r/(2*m),v*=r*r/(2*(m+1/2))),s=h*e.beta.cdf(l,m+.5,t/2)+v*e.beta.cdf(l,m+1,t/2),u+=.5*s,m++;return c?1-u:u}}),e.extend(e.normal,{pdf:function(n,t,r){return i.exp(-.5*i.log(2*i.PI)-i.log(r)-i.pow(n-t,2)/(2*r*r))},cdf:function(n,t,r){return .5*(1+e.erf((n-t)/i.sqrt(2*r*r)))},inv:function(n,t,r){return-1.4142135623730951*r*e.erfcinv(2*n)+t},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},sample:function(n,t){return e.randn()*t+n},variance:function(n,t){return t*t}}),e.extend(e.pareto,{pdf:function(n,t,r){return n<t?0:r*i.pow(t,r)/i.pow(n,r+1)},cdf:function(n,t,r){return n<t?0:1-i.pow(t/n,r)},inv:function(n,t,r){return t/i.pow(1-n,1/r)},mean:function(n,t){if(!(t<=1))return t*i.pow(n,t)/(t-1)},median:function(n,t){return n*(t*i.SQRT2)},mode:function(n){return n},variance:function(n,t){if(!(t<=2))return n*n*t/(i.pow(t-1,2)*(t-2))}}),e.extend(e.studentt,{pdf:function(n,t){return t=t>1e100?1e100:t,1/(i.sqrt(t)*e.betafn(.5,t/2))*i.pow(1+n*n/t,-((t+1)/2))},cdf:function(n,t){var r=t/2;return e.ibeta((n+i.sqrt(n*n+t))/(2*i.sqrt(n*n+t)),r,r)},inv:function(n,t){var r=e.ibetainv(2*i.min(n,1-n),.5*t,.5);return r=i.sqrt(t*(1-r)/r),n>.5?r:-r},mean:function(n){return n>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return e.randn()*i.sqrt(n/(2*e.randg(n/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),e.extend(e.weibull,{pdf:function(n,t,r){return n<0||t<0||r<0?0:r/t*i.pow(n/t,r-1)*i.exp(-i.pow(n/t,r))},cdf:function(n,t,r){return n<0?0:1-i.exp(-i.pow(n/t,r))},inv:function(n,t,r){return t*i.pow(-i.log(1-n),1/r)},mean:function(n,t){return n*e.gammafn(1+1/t)},median:function(n,t){return n*i.pow(i.log(2),1/t)},mode:function(n,t){return t<=1?0:n*i.pow((t-1)/t,1/t)},sample:function(n,t){return n*i.pow(-i.log(e._random_fn()),1/t)},variance:function(n,t){return n*n*e.gammafn(1+2/t)-i.pow(e.weibull.mean(n,t),2)}}),e.extend(e.uniform,{pdf:function(n,t,r){return n<t||n>r?0:1/(r-t)},cdf:function(n,t,r){return n<t?0:n<r?(n-t)/(r-t):1},inv:function(n,t,r){return t+n*(r-t)},mean:function(n,t){return .5*(n+t)},median:function(n,t){return e.mean(n,t)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,t){return n/2+t/2+(t/2-n/2)*(2*e._random_fn()-1)},variance:function(n,t){return i.pow(t-n,2)/12}});function d(n,t,r,o){for(var a=0,c=1,u=1,s=1,g=0,l=0,m;i.abs((u-l)/u)>o;)l=u,m=-(t+g)*(t+r+g)*n/(t+2*g)/(t+2*g+1),a=u+m*a,c=s+m*c,g=g+1,m=g*(r-g)*n/(t+2*g-1)/(t+2*g),u=a+m*u,s=c+m*s,a=a/s,c=c/s,u=u/s,s=1;return u/t}e.extend(e.binomial,{pdf:function(n,t,r){return r===0||r===1?t*r===n?1:0:e.combination(t,n)*i.pow(r,n)*i.pow(1-r,t-n)},cdf:function(n,t,r){var o,a=1e-10;if(n<0)return 0;if(n>=t)return 1;if(r<0||r>1||t<=0)return NaN;n=i.floor(n);var c=r,u=n+1,s=t-n,g=u+s,l=i.exp(e.gammaln(g)-e.gammaln(s)-e.gammaln(u)+u*i.log(c)+s*i.log(1-c));return c<(u+1)/(g+2)?o=l*d(c,u,s,a):o=1-l*d(1-c,s,u,a),i.round((1-o)*(1/a))/(1/a)}}),e.extend(e.negbin,{pdf:function(n,t,r){return n!==n>>>0?!1:n<0?0:e.combination(n+t-1,t-1)*i.pow(1-r,n)*i.pow(r,t)},cdf:function(n,t,r){var o=0,a=0;if(n<0)return 0;for(;a<=n;a++)o+=e.negbin.pdf(a,t,r);return o}}),e.extend(e.hypgeom,{pdf:function(n,t,r,o){if(n!==n|0)return!1;if(n<0||n<r-(t-o)||n>o||n>r)return 0;if(r*2>t)return o*2>t?e.hypgeom.pdf(t-r-o+n,t,t-r,t-o):e.hypgeom.pdf(o-n,t,t-r,o);if(o*2>t)return e.hypgeom.pdf(r-n,t,r,t-o);if(r<o)return e.hypgeom.pdf(n,t,o,r);for(var a=1,c=0,u=0;u<n;u++){for(;a>1&&c<o;)a*=1-r/(t-c),c++;a*=(o-u)*(r-u)/((u+1)*(t-r-o+u+1))}for(;c<o;c++)a*=1-r/(t-c);return i.min(1,i.max(0,a))},cdf:function(n,t,r,o){if(n<0||n<r-(t-o))return 0;if(n>=o||n>=r)return 1;if(r*2>t)return o*2>t?e.hypgeom.cdf(t-r-o+n,t,t-r,t-o):1-e.hypgeom.cdf(o-n-1,t,t-r,o);if(o*2>t)return 1-e.hypgeom.cdf(r-n-1,t,r,t-o);if(r<o)return e.hypgeom.cdf(n,t,o,r);for(var a=1,c=1,u=0,s=0;s<n;s++){for(;a>1&&u<o;){var g=1-r/(t-u);c*=g,a*=g,u++}c*=(o-s)*(r-s)/((s+1)*(t-r-o+s+1)),a+=c}for(;u<o;u++)a*=1-r/(t-u);return i.min(1,i.max(0,a))}}),e.extend(e.poisson,{pdf:function(n,t){return t<0||n%1!==0||n<0?0:i.pow(t,n)*i.exp(-t)/e.factorial(n)},cdf:function(n,t){var r=[],o=0;if(n<0)return 0;for(;o<=n;o++)r.push(e.poisson.pdf(o,t));return e.sum(r)},mean:function(n){return n},variance:function(n){return n},sampleSmall:function(n){var t=1,r=0,o=i.exp(-n);do r++,t*=e._random_fn();while(t>o);return r-1},sampleLarge:function(n){var t=n,r,o,a,c,u,s,g,l,m,h;for(c=i.sqrt(t),u=i.log(t),g=.931+2.53*c,s=-.059+.02483*g,l=1.1239+1.1328/(g-3.4),m=.9277-3.6224/(g-2);;)if(o=i.random()-.5,a=i.random(),h=.5-i.abs(o),r=i.floor((2*s/h+g)*o+t+.43),h>=.07&&a<=m||!(r<0||h<.013&&a>h)&&i.log(a)+i.log(l)-i.log(s/(h*h)+g)<=-t+r*u-e.loggam(r+1))return r},sample:function(n){return n<10?this.sampleSmall(n):this.sampleLarge(n)}}),e.extend(e.triangular,{pdf:function(n,t,r,o){return r<=t||o<t||o>r?NaN:n<t||n>r?0:n<o?2*(n-t)/((r-t)*(o-t)):n===o?2/(r-t):2*(r-n)/((r-t)*(r-o))},cdf:function(n,t,r,o){return r<=t||o<t||o>r?NaN:n<=t?0:n>=r?1:n<=o?i.pow(n-t,2)/((r-t)*(o-t)):1-i.pow(r-n,2)/((r-t)*(r-o))},inv:function(n,t,r,o){return r<=t||o<t||o>r?NaN:n<=(o-t)/(r-t)?t+(r-t)*i.sqrt(n*((o-t)/(r-t))):t+(r-t)*(1-i.sqrt((1-n)*(1-(o-t)/(r-t))))},mean:function(n,t,r){return(n+t+r)/3},median:function(n,t,r){if(r<=(n+t)/2)return t-i.sqrt((t-n)*(t-r))/i.sqrt(2);if(r>(n+t)/2)return n+i.sqrt((t-n)*(r-n))/i.sqrt(2)},mode:function(n,t,r){return r},sample:function(n,t,r){var o=e._random_fn();return o<(r-n)/(t-n)?n+i.sqrt(o*(t-n)*(r-n)):t-i.sqrt((1-o)*(t-n)*(t-r))},variance:function(n,t,r){return(n*n+t*t+r*r-n*t-n*r-t*r)/18}}),e.extend(e.arcsine,{pdf:function(n,t,r){return r<=t?NaN:n<=t||n>=r?0:2/i.PI*i.pow(i.pow(r-t,2)-i.pow(2*n-t-r,2),-.5)},cdf:function(n,t,r){return n<t?0:n<r?2/i.PI*i.asin(i.sqrt((n-t)/(r-t))):1},inv:function(n,t,r){return t+(.5-.5*i.cos(i.PI*n))*(r-t)},mean:function(n,t){return t<=n?NaN:(n+t)/2},median:function(n,t){return t<=n?NaN:(n+t)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,t){return(n+t)/2+(t-n)/2*i.sin(2*i.PI*e.uniform.sample(0,1))},variance:function(n,t){return t<=n?NaN:i.pow(t-n,2)/8}});function p(n){return n/i.abs(n)}e.extend(e.laplace,{pdf:function(n,t,r){return r<=0?0:i.exp(-i.abs(n-t)/r)/(2*r)},cdf:function(n,t,r){return r<=0?0:n<t?.5*i.exp((n-t)/r):1-.5*i.exp(-(n-t)/r)},mean:function(n){return n},median:function(n){return n},mode:function(n){return n},variance:function(n,t){return 2*t*t},sample:function(n,t){var r=e._random_fn()-.5;return n-t*p(r)*i.log(1-2*i.abs(r))}});function b(n,t,r){var o=12,a=6,c=-30,u=-50,s=60,g=8,l=3,m=2,h=3,v=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],w=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],y=n*.5;if(y>=g)return 1;var x=2*e.normal.cdf(y,0,1,1,0)-1;x>=i.exp(u/r)?x=i.pow(x,r):x=0;var q;n>l?q=m:q=h;for(var A=y,R=(g-y)/q,k=A+R,N=0,F=r-1,G=1;G<=q;G++){for(var E=0,D=.5*(k+A),T=.5*(k-A),j=1;j<=o;j++){var M,z;a<j?(M=o-j+1,z=v[M-1]):(M=j,z=-v[M-1]);var S=T*z,I=D+S,B=I*I;if(B>s)break;var O=2*e.normal.cdf(I,0,1,1,0),Y=2*e.normal.cdf(I,n,1,1,0),V=O*.5-Y*.5;V>=i.exp(c/F)&&(V=w[M-1]*i.exp(-(.5*B))*i.pow(V,F),E+=V)}E*=2*T*r/i.sqrt(2*i.PI),N+=E,A=k,k+=R}return x+=N,x<=i.exp(c/t)?0:(x=i.pow(x,t),x>=1?1:x)}function f(n,t,r){var o=.322232421088,a=.099348462606,c=-1,u=.588581570495,s=-.342242088547,g=.531103462366,l=-.204231210125,m=.10353775285,h=-453642210148e-16,v=.0038560700634,w=.8832,y=.2368,x=1.208,q=1.4142,A=120,R=.5-.5*n,k=i.sqrt(i.log(1/(R*R))),N=k+((((k*h+l)*k+s)*k+c)*k+o)/((((k*v+m)*k+g)*k+u)*k+a);r<A&&(N+=(N*N*N+N)/r/4);var F=w-y*N;return r<A&&(F+=-1.214/r+x*N/r),N*(F*i.log(t-1)+q)}e.extend(e.tukey,{cdf:function(n,t,r){var o=1,a=t,c=16,u=8,s=-30,g=1e-14,l=100,m=800,h=5e3,v=25e3,w=1,y=.5,x=.25,q=.125,A=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],R=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(r<2||o<1||a<2)return NaN;if(!Number.isFinite(n))return 1;if(r>v)return b(n,o,a);var k=r*.5,N=k*i.log(r)-r*i.log(2)-e.gammaln(k),F=k-1,G=r*.25,E;r<=l?E=w:r<=m?E=y:r<=h?E=x:E=q,N+=i.log(E);for(var D=0,T=1;T<=50;T++){for(var j=0,M=(2*T-1)*E,z=1;z<=c;z++){var S,I;u<z?(S=z-u-1,I=N+F*i.log(M+A[S]*E)-(A[S]*E+M)*G):(S=z-1,I=N+F*i.log(M-A[S]*E)+(A[S]*E-M)*G);var B;if(I>=s){u<z?B=n*i.sqrt((A[S]*E+M)*.5):B=n*i.sqrt((-(A[S]*E)+M)*.5);var O=b(B,o,a),Y=O*R[S]*i.exp(I);j+=Y}}if(T*E>=1&&j<=g)break;D+=j}if(j>g)throw new Error("tukey.cdf failed to converge");return D>1&&(D=1),D},inv:function(n,t,r){var o=1,a=t,c=1e-4,u=50;if(r<2||o<1||a<2)return NaN;if(n<0||n>1)return NaN;if(n===0)return 0;if(n===1)return 1/0;var s=f(n,a,r),g=e.tukey.cdf(s,t,r)-n,l;g>0?l=i.max(0,s-1):l=s+1;for(var m=e.tukey.cdf(l,t,r)-n,h,v=1;v<u;v++){h=l-m*(l-s)/(m-g),g=m,s=l,h<0&&(h=0,m=-n),m=e.tukey.cdf(h,t,r)-n,l=h;var w=i.abs(l-s);if(w<c)return h}throw new Error("tukey.inv failed to converge")}})}(_,Math),function(e,i){var d=Array.prototype.push,p=e.utils.isArray;function b(f){return p(f)||f instanceof e}e.extend({add:function(f,n){return b(n)?(b(n[0])||(n=[n]),e.map(f,function(t,r,o){return t+n[r][o]})):e.map(f,function(t){return t+n})},subtract:function(f,n){return b(n)?(b(n[0])||(n=[n]),e.map(f,function(t,r,o){return t-n[r][o]||0})):e.map(f,function(t){return t-n})},divide:function(f,n){return b(n)?(b(n[0])||(n=[n]),e.multiply(f,e.inv(n))):e.map(f,function(t){return t/n})},multiply:function(f,n){var t,r,o,a,c,u,s,g;if(f.length===void 0&&n.length===void 0)return f*n;if(c=f.length,u=f[0].length,s=e.zeros(c,o=b(n)?n[0].length:u),g=0,b(n)){for(;g<o;g++)for(t=0;t<c;t++){for(a=0,r=0;r<u;r++)a+=f[t][r]*n[r][g];s[t][g]=a}return c===1&&g===1?s[0][0]:s}return e.map(f,function(l){return l*n})},outer:function(f,n){return e.multiply(f.map(function(t){return[t]}),[n])},dot:function(f,n){b(f[0])||(f=[f]),b(n[0])||(n=[n]);for(var t=f[0].length===1&&f.length!==1?e.transpose(f):f,r=n[0].length===1&&n.length!==1?e.transpose(n):n,o=[],a=0,c=t.length,u=t[0].length,s,g;a<c;a++){for(o[a]=[],s=0,g=0;g<u;g++)s+=t[a][g]*r[a][g];o[a]=s}return o.length===1?o[0]:o},pow:function(f,n){return e.map(f,function(t){return i.pow(t,n)})},exp:function(f){return e.map(f,function(n){return i.exp(n)})},log:function(f){return e.map(f,function(n){return i.log(n)})},abs:function(f){return e.map(f,function(n){return i.abs(n)})},norm:function(f,n){var t=0,r=0;for(isNaN(n)&&(n=2),b(f[0])&&(f=f[0]);r<f.length;r++)t+=i.pow(i.abs(f[r]),n);return i.pow(t,1/n)},angle:function(f,n){return i.acos(e.dot(f,n)/(e.norm(f)*e.norm(n)))},aug:function(f,n){var t=[],r;for(r=0;r<f.length;r++)t.push(f[r].slice());for(r=0;r<t.length;r++)d.apply(t[r],n[r]);return t},inv:function(f){for(var n=f.length,t=f[0].length,r=e.identity(n,t),o=e.gauss_jordan(f,r),a=[],c=0,u;c<n;c++)for(a[c]=[],u=t;u<o[0].length;u++)a[c][u-t]=o[c][u];return a},det:function f(n){if(n.length===2)return n[0][0]*n[1][1]-n[0][1]*n[1][0];for(var t=0,r=0;r<n.length;r++){for(var o=[],a=1;a<n.length;a++){o[a-1]=[];for(var c=0;c<n.length;c++)c<r?o[a-1][c]=n[a][c]:c>r&&(o[a-1][c-1]=n[a][c])}var u=r%2?-1:1;t+=f(o)*n[0][r]*u}return t},gauss_elimination:function(f,n){var t=0,r=0,o=f.length,a=f[0].length,c=1,u=0,s=[],g,l,m,h;for(f=e.aug(f,n),g=f[0].length,t=0;t<o;t++){for(l=f[t][t],r=t,h=t+1;h<a;h++)l<i.abs(f[h][t])&&(l=f[h][t],r=h);if(r!=t)for(h=0;h<g;h++)m=f[t][h],f[t][h]=f[r][h],f[r][h]=m;for(r=t+1;r<o;r++)for(c=f[r][t]/f[t][t],h=t;h<g;h++)f[r][h]=f[r][h]-c*f[t][h]}for(t=o-1;t>=0;t--){for(u=0,r=t+1;r<=o-1;r++)u=u+s[r]*f[t][r];s[t]=(f[t][g-1]-u)/f[t][t]}return s},gauss_jordan:function(f,n){var t=e.aug(f,n),r=t.length,o=t[0].length,a=0,c,u,s;for(u=0;u<r;u++){var g=u;for(s=u+1;s<r;s++)i.abs(t[s][u])>i.abs(t[g][u])&&(g=s);var l=t[u];for(t[u]=t[g],t[g]=l,s=u+1;s<r;s++)for(a=t[s][u]/t[u][u],c=u;c<o;c++)t[s][c]-=t[u][c]*a}for(u=r-1;u>=0;u--){for(a=t[u][u],s=0;s<u;s++)for(c=o-1;c>u-1;c--)t[s][c]-=t[u][c]*t[s][u]/a;for(t[u][u]/=a,c=r;c<o;c++)t[u][c]/=a}return t},triaUpSolve:function(f,n){var t=f[0].length,r=e.zeros(1,t)[0],o,a=!1;return n[0].length!=null&&(n=n.map(function(c){return c[0]}),a=!0),e.arange(t-1,-1,-1).forEach(function(c){o=e.arange(c+1,t).map(function(u){return r[u]*f[c][u]}),r[c]=(n[c]-e.sum(o))/f[c][c]}),a?r.map(function(c){return[c]}):r},triaLowSolve:function(f,n){var t=f[0].length,r=e.zeros(1,t)[0],o,a=!1;return n[0].length!=null&&(n=n.map(function(c){return c[0]}),a=!0),e.arange(t).forEach(function(c){o=e.arange(c).map(function(u){return f[c][u]*r[u]}),r[c]=(n[c]-e.sum(o))/f[c][c]}),a?r.map(function(c){return[c]}):r},lu:function(f){var n=f.length,t=e.identity(n),r=e.zeros(f.length,f[0].length),o;return e.arange(n).forEach(function(a){r[0][a]=f[0][a]}),e.arange(1,n).forEach(function(a){e.arange(a).forEach(function(c){o=e.arange(c).map(function(u){return t[a][u]*r[u][c]}),t[a][c]=(f[a][c]-e.sum(o))/r[c][c]}),e.arange(a,n).forEach(function(c){o=e.arange(a).map(function(u){return t[a][u]*r[u][c]}),r[a][c]=f[o.length][c]-e.sum(o)})}),[t,r]},cholesky:function(f){var n=f.length,t=e.zeros(f.length,f[0].length),r;return e.arange(n).forEach(function(o){r=e.arange(o).map(function(a){return i.pow(t[o][a],2)}),t[o][o]=i.sqrt(f[o][o]-e.sum(r)),e.arange(o+1,n).forEach(function(a){r=e.arange(o).map(function(c){return t[o][c]*t[a][c]}),t[a][o]=(f[o][a]-e.sum(r))/t[o][o]})}),t},gauss_jacobi:function(f,n,t,r){for(var o=0,a=0,c=f.length,u=[],s=[],g=[],l,m,h,v;o<c;o++)for(u[o]=[],s[o]=[],g[o]=[],a=0;a<c;a++)o>a?(u[o][a]=f[o][a],s[o][a]=g[o][a]=0):o<a?(s[o][a]=f[o][a],u[o][a]=g[o][a]=0):(g[o][a]=f[o][a],u[o][a]=s[o][a]=0);for(h=e.multiply(e.multiply(e.inv(g),e.add(u,s)),-1),m=e.multiply(e.inv(g),n),l=t,v=e.add(e.multiply(h,t),m),o=2;i.abs(e.norm(e.subtract(v,l)))>r;)l=v,v=e.add(e.multiply(h,l),m),o++;return v},gauss_seidel:function(f,n,t,r){for(var o=0,a=f.length,c=[],u=[],s=[],g,l,m,h,v;o<a;o++)for(c[o]=[],u[o]=[],s[o]=[],g=0;g<a;g++)o>g?(c[o][g]=f[o][g],u[o][g]=s[o][g]=0):o<g?(u[o][g]=f[o][g],c[o][g]=s[o][g]=0):(s[o][g]=f[o][g],c[o][g]=u[o][g]=0);for(h=e.multiply(e.multiply(e.inv(e.add(s,c)),u),-1),m=e.multiply(e.inv(e.add(s,c)),n),l=t,v=e.add(e.multiply(h,t),m),o=2;i.abs(e.norm(e.subtract(v,l)))>r;)l=v,v=e.add(e.multiply(h,l),m),o=o+1;return v},SOR:function(f,n,t,r,o){for(var a=0,c=f.length,u=[],s=[],g=[],l,m,h,v,w;a<c;a++)for(u[a]=[],s[a]=[],g[a]=[],l=0;l<c;l++)a>l?(u[a][l]=f[a][l],s[a][l]=g[a][l]=0):a<l?(s[a][l]=f[a][l],u[a][l]=g[a][l]=0):(g[a][l]=f[a][l],u[a][l]=s[a][l]=0);for(v=e.multiply(e.inv(e.add(g,e.multiply(u,o))),e.subtract(e.multiply(g,1-o),e.multiply(s,o))),h=e.multiply(e.multiply(e.inv(e.add(g,e.multiply(u,o))),n),o),m=t,w=e.add(e.multiply(v,t),h),a=2;i.abs(e.norm(e.subtract(w,m)))>r;)m=w,w=e.add(e.multiply(v,m),h),a++;return w},householder:function(f){for(var n=f.length,t=f[0].length,r=0,o=[],a=[],c,u,s,g,l;r<n-1;r++){for(c=0,g=r+1;g<t;g++)c+=f[g][r]*f[g][r];for(l=f[r+1][r]>0?-1:1,c=l*i.sqrt(c),u=i.sqrt((c*c-f[r+1][r]*c)/2),o=e.zeros(n,1),o[r+1][0]=(f[r+1][r]-c)/(2*u),s=r+2;s<n;s++)o[s][0]=f[s][r]/(2*u);a=e.subtract(e.identity(n,t),e.multiply(e.multiply(o,e.transpose(o)),2)),f=e.multiply(a,e.multiply(f,a))}return f},QR:function(){var f=e.sum,n=e.arange;function t(r){var o=r.length,a=r[0].length,c=e.zeros(a,a);r=e.copy(r);var u,s,g;for(s=0;s<a;s++){for(c[s][s]=i.sqrt(f(n(o).map(function(l){return r[l][s]*r[l][s]}))),u=0;u<o;u++)r[u][s]=r[u][s]/c[s][s];for(g=s+1;g<a;g++)for(c[s][g]=f(n(o).map(function(l){return r[l][s]*r[l][g]})),u=0;u<o;u++)r[u][g]=r[u][g]-r[u][s]*c[s][g]}return[r,c]}return t}(),lstsq:function(){function f(t){t=e.copy(t);var r=t.length,o=e.identity(r);return e.arange(r-1,-1,-1).forEach(function(a){e.sliceAssign(o,{row:a},e.divide(e.slice(o,{row:a}),t[a][a])),e.sliceAssign(t,{row:a},e.divide(e.slice(t,{row:a}),t[a][a])),e.arange(a).forEach(function(c){var u=e.multiply(t[c][a],-1),s=e.slice(t,{row:c}),g=e.multiply(e.slice(t,{row:a}),u);e.sliceAssign(t,{row:c},e.add(s,g));var l=e.slice(o,{row:c}),m=e.multiply(e.slice(o,{row:a}),u);e.sliceAssign(o,{row:c},e.add(l,m))})}),o}function n(t,r){var o=!1;r[0].length===void 0&&(r=r.map(function(w){return[w]}),o=!0);var a=e.QR(t),c=a[0],u=a[1],s=t[0].length,g=e.slice(c,{col:{end:s}}),l=e.slice(u,{row:{end:s}}),m=f(l),h=e.transpose(g);h[0].length===void 0&&(h=[h]);var v=e.multiply(e.multiply(m,h),r);return v.length===void 0&&(v=[[v]]),o?v.map(function(w){return w[0]}):v}return n}(),jacobi:function(f){for(var n=1,t=f.length,r=e.identity(t,t),o=[],a,c,u,s,g,l,m,h;n===1;){for(l=f[0][1],s=0,g=1,c=0;c<t;c++)for(u=0;u<t;u++)c!=u&&l<i.abs(f[c][u])&&(l=i.abs(f[c][u]),s=c,g=u);for(f[s][s]===f[g][g]?m=f[s][g]>0?i.PI/4:-i.PI/4:m=i.atan(2*f[s][g]/(f[s][s]-f[g][g]))/2,h=e.identity(t,t),h[s][s]=i.cos(m),h[s][g]=-i.sin(m),h[g][s]=i.sin(m),h[g][g]=i.cos(m),r=e.multiply(r,h),a=e.multiply(e.multiply(e.inv(h),f),h),f=a,n=0,c=1;c<t;c++)for(u=1;u<t;u++)c!=u&&i.abs(f[c][u])>.001&&(n=1)}for(c=0;c<t;c++)o.push(f[c][c]);return[r,o]},rungekutta:function(f,n,t,r,o,a){var c,u,s,g,l;if(a===2)for(;r<=t;)c=n*f(r,o),u=n*f(r+n,o+c),s=o+(c+u)/2,o=s,r=r+n;if(a===4)for(;r<=t;)c=n*f(r,o),u=n*f(r+n/2,o+c/2),g=n*f(r+n/2,o+u/2),l=n*f(r+n,o+g),s=o+(c+2*u+2*g+l)/6,o=s,r=r+n;return o},romberg:function(f,n,t,r){for(var o=0,a=(t-n)/2,c=[],u=[],s=[],g,l,m,h,v;o<r/2;){for(v=f(n),m=n,h=0;m<=t;m=m+a,h++)c[h]=m;for(g=c.length,m=1;m<g-1;m++)v+=(m%2!==0?4:2)*f(c[m]);v=a/3*(v+f(t)),s[o]=v,a/=2,o++}for(l=s.length,g=1;l!==1;){for(m=0;m<l-1;m++)u[m]=(i.pow(4,g)*s[m+1]-s[m])/(i.pow(4,g)-1);l=u.length,s=u,u=[],g++}return s},richardson:function(f,n,t,r){function o(w,y){for(var x=0,q=w.length,A;x<q;x++)w[x]===y&&(A=x);return A}for(var a=i.abs(t-f[o(f,t)+1]),c=0,u=[],s=[],g,l,m,h,v;r>=a;)g=o(f,t+r),l=o(f,t),u[c]=(n[g]-2*n[l]+n[2*l-g])/(r*r),r/=2,c++;for(h=u.length,m=1;h!=1;){for(v=0;v<h-1;v++)s[v]=(i.pow(4,m)*u[v+1]-u[v])/(i.pow(4,m)-1);h=s.length,u=s,s=[],m++}return u},simpson:function(f,n,t,r){for(var o=(t-n)/r,a=f(n),c=[],u=n,s=0,g=1,l;u<=t;u=u+o,s++)c[s]=u;for(l=c.length;g<l-1;g++)a+=(g%2!==0?4:2)*f(c[g]);return o/3*(a+f(t))},hermite:function(f,n,t,r){for(var o=f.length,a=0,c=0,u=[],s=[],g=[],l=[],m;c<o;c++){for(u[c]=1,m=0;m<o;m++)c!=m&&(u[c]*=(r-f[m])/(f[c]-f[m]));for(s[c]=0,m=0;m<o;m++)c!=m&&(s[c]+=1/(f[c]-f[m]));g[c]=(1-2*(r-f[c])*s[c])*(u[c]*u[c]),l[c]=(r-f[c])*(u[c]*u[c]),a+=g[c]*n[c]+l[c]*t[c]}return a},lagrange:function(f,n,t){for(var r=0,o=0,a,c,u=f.length;o<u;o++){for(c=n[o],a=0;a<u;a++)o!=a&&(c*=(t-f[a])/(f[o]-f[a]));r+=c}return r},cubic_spline:function(f,n,t){for(var r=f.length,o=0,a,c=[],u=[],s=[],g=[],l=[],m=[],h=[];o<r-1;o++)l[o]=f[o+1]-f[o];for(s[0]=0,o=1;o<r-1;o++)s[o]=3/l[o]*(n[o+1]-n[o])-3/l[o-1]*(n[o]-n[o-1]);for(o=1;o<r-1;o++)c[o]=[],u[o]=[],c[o][o-1]=l[o-1],c[o][o]=2*(l[o-1]+l[o]),c[o][o+1]=l[o],u[o][0]=s[o];for(g=e.multiply(e.inv(c),u),a=0;a<r-1;a++)m[a]=(n[a+1]-n[a])/l[a]-l[a]*(g[a+1][0]+2*g[a][0])/3,h[a]=(g[a+1][0]-g[a][0])/(3*l[a]);for(a=0;a<r&&!(f[a]>t);a++);return a-=1,n[a]+(t-f[a])*m[a]+e.sq(t-f[a])*g[a]+(t-f[a])*e.sq(t-f[a])*h[a]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(f){var n=f.length,t=f[0].length,r=0,o,a,c=[],u=[],s=[],g=[],l=[],m=[],h=[],v=[],w=[],y=[];for(r=0;r<n;r++)c[r]=e.sum(f[r])/t;for(r=0;r<t;r++)for(h[r]=[],o=0;o<n;o++)h[r][o]=f[o][r]-c[o];for(h=e.transpose(h),r=0;r<n;r++)for(v[r]=[],o=0;o<n;o++)v[r][o]=e.dot([h[r]],[h[o]])/(t-1);for(s=e.jacobi(v),w=s[0],u=s[1],y=e.transpose(w),r=0;r<u.length;r++)for(o=r;o<u.length;o++)u[r]<u[o]&&(a=u[r],u[r]=u[o],u[o]=a,g=y[r],y[r]=y[o],y[o]=g);for(m=e.transpose(h),r=0;r<n;r++)for(l[r]=[],o=0;o<m.length;o++)l[r][o]=e.dot([y[r]],[m[o]]);return[f,u,y,l]}}),function(f){for(var n=0;n<f.length;n++)(function(t){e.fn[t]=function(r,o){var a=this;return o?(setTimeout(function(){o.call(a,e.fn[t].call(a,r))},15),this):typeof e[t](this,r)=="number"?e[t](this,r):e(e[t](this,r))}})(f[n])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(_,Math),function(e,i){var d=[].slice,p=e.utils.isNumber,b=e.utils.isArray;e.extend({zscore:function(){var n=d.call(arguments);return p(n[1])?(n[0]-n[1])/n[2]:(n[0]-e.mean(n[1]))/e.stdev(n[1],n[2])},ztest:function(){var n=d.call(arguments),t;return b(n[1])?(t=e.zscore(n[0],n[1],n[3]),n[2]===1?e.normal.cdf(-i.abs(t),0,1):e.normal.cdf(-i.abs(t),0,1)*2):n.length>2?(t=e.zscore(n[0],n[1],n[2]),n[3]===1?e.normal.cdf(-i.abs(t),0,1):e.normal.cdf(-i.abs(t),0,1)*2):(t=n[0],n[1]===1?e.normal.cdf(-i.abs(t),0,1):e.normal.cdf(-i.abs(t),0,1)*2)}}),e.extend(e.fn,{zscore:function(n,t){return(n-this.mean())/this.stdev(t)},ztest:function(n,t,r){var o=i.abs(this.zscore(n,r));return t===1?e.normal.cdf(-o,0,1):e.normal.cdf(-o,0,1)*2}}),e.extend({tscore:function(){var n=d.call(arguments);return n.length===4?(n[0]-n[1])/(n[2]/i.sqrt(n[3])):(n[0]-e.mean(n[1]))/(e.stdev(n[1],!0)/i.sqrt(n[1].length))},ttest:function(){var n=d.call(arguments),t;return n.length===5?(t=i.abs(e.tscore(n[0],n[1],n[2],n[3])),n[4]===1?e.studentt.cdf(-t,n[3]-1):e.studentt.cdf(-t,n[3]-1)*2):p(n[1])?(t=i.abs(n[0]),n[2]==1?e.studentt.cdf(-t,n[1]-1):e.studentt.cdf(-t,n[1]-1)*2):(t=i.abs(e.tscore(n[0],n[1])),n[2]==1?e.studentt.cdf(-t,n[1].length-1):e.studentt.cdf(-t,n[1].length-1)*2)}}),e.extend(e.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/i.sqrt(this.cols()))},ttest:function(n,t){return t===1?1-e.studentt.cdf(i.abs(this.tscore(n)),this.cols()-1):e.studentt.cdf(-i.abs(this.tscore(n)),this.cols()-1)*2}}),e.extend({anovafscore:function(){var n=d.call(arguments),t,r,o,a,c,u,s,g;if(n.length===1){for(c=new Array(n[0].length),s=0;s<n[0].length;s++)c[s]=n[0][s];n=c}for(r=new Array,s=0;s<n.length;s++)r=r.concat(n[s]);for(o=e.mean(r),t=0,s=0;s<n.length;s++)t=t+n[s].length*i.pow(e.mean(n[s])-o,2);for(t/=n.length-1,u=0,s=0;s<n.length;s++)for(a=e.mean(n[s]),g=0;g<n[s].length;g++)u+=i.pow(n[s][g]-a,2);return u/=r.length-n.length,t/u},anovaftest:function(){var n=d.call(arguments),t,r,o,a;if(p(n[0]))return 1-e.centralF.cdf(n[0],n[1],n[2]);var c=e.anovafscore(n);for(t=n.length-1,o=0,a=0;a<n.length;a++)o=o+n[a].length;return r=o-t-1,1-e.centralF.cdf(c,t,r)},ftest:function(n,t,r){return 1-e.centralF.cdf(n,t,r)}}),e.extend(e.fn,{anovafscore:function(){return e.anovafscore(this.toArray())},anovaftes:function(){var n=0,t;for(t=0;t<this.length;t++)n=n+this[t].length;return e.ftest(this.anovafscore(),this.length-1,n-this.length)}}),e.extend({qscore:function(){var n=d.call(arguments),t,r,o,a,c;return p(n[0])?(t=n[0],r=n[1],o=n[2],a=n[3],c=n[4]):(t=e.mean(n[0]),r=e.mean(n[1]),o=n[0].length,a=n[1].length,c=n[2]),i.abs(t-r)/(c*i.sqrt((1/o+1/a)/2))},qtest:function(){var n=d.call(arguments),t;n.length===3?(t=n[0],n=n.slice(1)):n.length===7?(t=e.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(t=e.qscore(n[0],n[1],n[2]),n=n.slice(3));var r=n[0],o=n[1];return 1-e.tukey.cdf(t,o,r-o)},tukeyhsd:function(n){for(var t=e.pooledstdev(n),r=n.map(function(g){return e.mean(g)}),o=n.reduce(function(g,l){return g+l.length},0),a=[],c=0;c<n.length;++c)for(var u=c+1;u<n.length;++u){var s=e.qtest(r[c],r[u],n[c].length,n[u].length,t,o,n.length);a.push([[c,u],s])}return a}}),e.extend({normalci:function(){var n=d.call(arguments),t=new Array(2),r;return n.length===4?r=i.abs(e.normal.inv(n[1]/2,0,1)*n[2]/i.sqrt(n[3])):r=i.abs(e.normal.inv(n[1]/2,0,1)*e.stdev(n[2])/i.sqrt(n[2].length)),t[0]=n[0]-r,t[1]=n[0]+r,t},tci:function(){var n=d.call(arguments),t=new Array(2),r;return n.length===4?r=i.abs(e.studentt.inv(n[1]/2,n[3]-1)*n[2]/i.sqrt(n[3])):r=i.abs(e.studentt.inv(n[1]/2,n[2].length-1)*e.stdev(n[2],!0)/i.sqrt(n[2].length)),t[0]=n[0]-r,t[1]=n[0]+r,t},significant:function(n,t){return n<t}}),e.extend(e.fn,{normalci:function(n,t){return e.normalci(n,t,this.toArray())},tci:function(n,t){return e.tci(n,t,this.toArray())}});function f(n,t,r,o){if(n>1||r>1||n<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var a=(n*t+r*o)/(t+o),c=i.sqrt(a*(1-a)*(1/t+1/o));return(n-r)/c}e.extend(e.fn,{oneSidedDifferenceOfProportions:function(n,t,r,o){var a=f(n,t,r,o);return e.ztest(a,1)},twoSidedDifferenceOfProportions:function(n,t,r,o){var a=f(n,t,r,o);return e.ztest(a,2)}})}(_,Math),_.models=function(){function e(f){var n=f[0].length,t=_.arange(n).map(function(r){var o=_.arange(n).filter(function(a){return a!==r});return i(_.col(f,r).map(function(a){return a[0]}),_.col(f,o))});return t}function i(f,n){var t=f.length,r=n[0].length-1,o=t-r-1,a=_.lstsq(n,f),c=_.multiply(n,a.map(function(v){return[v]})).map(function(v){return v[0]}),u=_.subtract(f,c),s=_.mean(f),g=_.sum(c.map(function(v){return Math.pow(v-s,2)})),l=_.sum(f.map(function(v,w){return Math.pow(v-c[w],2)})),m=g+l,h=g/m;return{exog:n,endog:f,nobs:t,df_model:r,df_resid:o,coef:a,predict:c,resid:u,ybar:s,SST:m,SSE:g,SSR:l,R2:h}}function d(f){var n=e(f.exog),t=Math.sqrt(f.SSR/f.df_resid),r=n.map(function(s){var g=s.SST,l=s.R2;return t/Math.sqrt(g*(1-l))}),o=f.coef.map(function(s,g){return(s-0)/r[g]}),a=o.map(function(s){var g=_.studentt.cdf(s,f.df_resid);return(g>.5?1-g:g)*2}),c=_.studentt.inv(.975,f.df_resid),u=f.coef.map(function(s,g){var l=c*r[g];return[s-l,s+l]});return{se:r,t:o,p:a,sigmaHat:t,interval95:u}}function p(f){var n=f.R2/f.df_model/((1-f.R2)/f.df_resid),t=function(o,a,c){return _.beta.cdf(o/(c/a+o),a/2,c/2)},r=1-t(n,f.df_model,f.df_resid);return{F_statistic:n,pvalue:r}}function b(f,n){var t=i(f,n),r=d(t),o=p(t),a=1-(1-t.R2)*((t.nobs-1)/t.df_resid);return t.t=r,t.f=o,t.adjust_R2=a,t}return{ols:b}}(),_.extend({buildxmatrix:function(){for(var e=new Array(arguments.length),i=0;i<arguments.length;i++){var d=[1];e[i]=d.concat(arguments[i])}return _(e)},builddxmatrix:function(){for(var e=new Array(arguments[0].length),i=0;i<arguments[0].length;i++){var d=[1];e[i]=d.concat(arguments[0][i])}return _(e)},buildjxmatrix:function(e){for(var i=new Array(e.length),d=0;d<e.length;d++)i[d]=e[d];return _.builddxmatrix(i)},buildymatrix:function(e){return _(e).transpose()},buildjymatrix:function(e){return e.transpose()},matrixmult:function(e,i){var d,p,b,f,n;if(e.cols()==i.rows()){if(i.rows()>1){for(f=[],d=0;d<e.rows();d++)for(f[d]=[],p=0;p<i.cols();p++){for(n=0,b=0;b<e.cols();b++)n+=e.toArray()[d][b]*i.toArray()[b][p];f[d][p]=n}return _(f)}for(f=[],d=0;d<e.rows();d++)for(f[d]=[],p=0;p<i.cols();p++){for(n=0,b=0;b<e.cols();b++)n+=e.toArray()[d][b]*i.toArray()[p];f[d][p]=n}return _(f)}},regress:function(e,i){var d=_.xtranspxinv(e),p=e.transpose(),b=_.matrixmult(_(d),p);return _.matrixmult(b,i)},regresst:function(e,i,d){var p=_.regress(e,i),b={};b.anova={};var f=_.jMatYBar(e,p);b.yBar=f;var n=i.mean();b.anova.residuals=_.residuals(i,f),b.anova.ssr=_.ssr(f,n),b.anova.msr=b.anova.ssr/(e[0].length-1),b.anova.sse=_.sse(i,f),b.anova.mse=b.anova.sse/(i.length-(e[0].length-1)-1),b.anova.sst=_.sst(i,n),b.anova.mst=b.anova.sst/(i.length-1),b.anova.r2=1-b.anova.sse/b.anova.sst,b.anova.r2<0&&(b.anova.r2=0),b.anova.fratio=b.anova.msr/b.anova.mse,b.anova.pvalue=_.anovaftest(b.anova.fratio,e[0].length-1,i.length-(e[0].length-1)-1),b.anova.rmse=Math.sqrt(b.anova.mse),b.anova.r2adj=1-b.anova.mse/b.anova.mst,b.anova.r2adj<0&&(b.anova.r2adj=0),b.stats=new Array(e[0].length);for(var t=_.xtranspxinv(e),r,o,a,c=0;c<p.length;c++)r=Math.sqrt(b.anova.mse*Math.abs(t[c][c])),o=Math.abs(p[c]/r),a=_.ttest(o,i.length-e[0].length-1,d),b.stats[c]=[p[c],r,o,a];return b.regress=p,b},xtranspx:function(e){return _.matrixmult(e.transpose(),e)},xtranspxinv:function(e){var i=_.matrixmult(e.transpose(),e),d=_.inv(i);return d},jMatYBar:function(e,i){var d=_.matrixmult(e,i);return new _(d)},residuals:function(e,i){return _.matrixsubtract(e,i)},ssr:function(e,i){for(var d=0,p=0;p<e.length;p++)d+=Math.pow(e[p]-i,2);return d},sse:function(e,i){for(var d=0,p=0;p<e.length;p++)d+=Math.pow(e[p]-i[p],2);return d},sst:function(e,i){for(var d=0,p=0;p<e.length;p++)d+=Math.pow(e[p]-i,2);return d},matrixsubtract:function(e,i){for(var d=new Array(e.length),p=0;p<e.length;p++){d[p]=new Array(e[p].length);for(var b=0;b<e[p].length;b++)d[p][b]=e[p][b]-i[p][b]}return _(d)}}),_.jStat=_,_})})(J);var H=J.exports,K=C(H);export{K as default};
